---
/*
  This is not a layout but just a component that's used in layouts.
*/
---

<script is:inline>
  import { THEME_STORAGE_KEY, Theme } from '../lib/theme'

  const theme = (() => {
    if (
      typeof localStorage !== 'undefined' &&
      localStorage.getItem(THEME_STORAGE_KEY)
    ) {
      return localStorage.getItem(THEME_STORAGE_KEY)
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return Theme.DARK
    }
    return Theme.LIGHT
  })()

  if (theme === Theme.LIGHT) {
    document.documentElement.classList.remove(Theme.DARK)
  } else {
    document.documentElement.classList.add(Theme.DARK)
  }
  window.localStorage.setItem(THEME_STORAGE_KEY, theme)
</script>
